%%
M = [1,0, 0, 0, 0,0,0,0, 0;
     0,0, 0, 0, 1,0,0,0, 0;
     0,0, 0, 0, 0,1,0,0, 0;
     0,0, 0, 0, 0,0,1,0, 0;
     0,0, 0, 0, 0,0,0,0, 3];
 N =[0,1, 0, 0, 0,0,0,0, 0;
     0,0, 0, 0, 0,1,0,0, 0;
     0,0, 0, 0, 0,0,1,0, 0;
     0,0, 0, 0, 0,0,0,1, 0;
     0,0, 0, 0, 0,0,0,0, 2];

parse_gklf(N,M)
[r,nu_r,nu_l] = nrankp(N,M)

%%
n = 14;
rng(5);
M = rand(n);
N = rand(n);
eig(N,M)
parse_gklf(N,M)
[V,info]=mpdefsub(M,N);
V
S = info.S;
M*V*S-N*V
eig(S)
[r,nu_r,nu_l] = nrankp(N,M)